package org.exploit.crypto.curve;

import org.exploit.crypto.constant.SupportedCurve;
import org.exploit.crypto.key.ECKeyPair;
import org.exploit.crypto.key.ECPrivateKey;
import org.exploit.crypto.key.ECPublicKey;
import org.exploit.crypto.schnorr.TaprootSchnorrSigner;
import org.exploit.tss.curve.PointOps;
import org.exploit.tss.signature.Signature;

public interface CurveProvider<P extends PointOps<P>> {
    ECKeyPair<P> generateKeyPair();

    Signature sign(byte[] data, ECKeyPair<P> keyPair);

    boolean verify(byte[] data, Signature signature, ECPublicKey<P> publicKey);

    boolean isValidPublicKey(byte[] key);

    default boolean isValidKeyPair(ECPublicKey<P> publicKey, ECPrivateKey privateKey) {
        return getPublicKey(privateKey).hex().equals(publicKey.hex());
    }

    TaprootSchnorrSigner schnorr();

    ECPublicKey<P> getPublicKey(ECPrivateKey privateKey);

    SupportedCurve type();
}