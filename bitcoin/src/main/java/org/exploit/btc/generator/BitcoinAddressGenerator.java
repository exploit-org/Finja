package org.exploit.btc.generator;

import org.exploit.crypto.key.ECKeyPair;
import org.exploit.crypto.key.ECPublicKey;
import org.exploit.finja.core.AddressGenerator;
import org.exploit.finja.core.model.CommonAddress;
import org.exploit.secp256k1.Secp256k1PointOps;

public interface BitcoinAddressGenerator extends AddressGenerator<Secp256k1PointOps> {
    String encodePublicAddress(ECPublicKey<Secp256k1PointOps> publicKey);

    @Override
    default CommonAddress generate(ECKeyPair<Secp256k1PointOps> keyPair) {
        var publicAddress = encodePublicAddress(keyPair.publicKey());
        var ecKey = keyPair.privateKey() == null ? null : keyPair.privateKey().encoded();

        return new CommonAddress(publicAddress, ecKey);
    }
}
