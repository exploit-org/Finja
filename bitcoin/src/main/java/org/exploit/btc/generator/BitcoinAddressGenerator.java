package org.exploit.btc.generator;

import org.exploit.crypto.key.ECKeyPair;
import org.exploit.crypto.key.ECPublicKey;
import org.exploit.finja.core.AddressGenerator;
import org.exploit.finja.core.model.CommonAddress;

public interface BitcoinAddressGenerator extends AddressGenerator {
    String encodePublicAddress(ECPublicKey publicKey);

    @Override
    default CommonAddress generate(ECKeyPair keyPair) {
        var publicAddress = encodePublicAddress(keyPair.publicKey());
        var ecKey = keyPair.privateKey() == null ? null : keyPair.privateKey().encoded();

        return new CommonAddress(publicAddress, ecKey);
    }
}
