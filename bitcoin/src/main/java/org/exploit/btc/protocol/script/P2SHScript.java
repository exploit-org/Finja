package org.exploit.btc.protocol.script;

import org.exploit.btc.protocol.Script;
import org.exploit.crypto.Base58;

import static org.exploit.btc.constant.OpCode.OP_EQUAL;
import static org.exploit.btc.constant.OpCode.OP_HASH160;

public class P2SHScript implements BitcoinScript {
    @Override
    public Script createScript(byte[] hash) {
        return new Script()
                .op(OP_HASH160)
                .push(hash)
                .op(OP_EQUAL);
    }

    @Override
    public byte[] extractHash(String address) {
        return Base58.getInstance().decodeCheck(address).second();
    }
}
