package org.exploit.btc.protocol.script;

import org.exploit.btc.protocol.Script;
import org.exploit.btc.utils.Witness;
import org.exploit.crypto.key.ECPublicKey;
import org.exploit.secp256k1.Secp256k1PointOps;

import static org.exploit.btc.constant.OpCode.OP_0;

public class P2WSHScript implements BitcoinScript {
    @Override
    public Script createScript(byte[] hash) {
        return new Script()
                .op(OP_0)
                .push(hash);
    }

    @Override
    public Script createSignatureScript(byte[] signature, ECPublicKey<Secp256k1PointOps> publicKey) {
        throw new UnsupportedOperationException();
    }

    @Override
    public byte[] extractHash(String address) {
        return Witness.decode(address);
    }

    @Override
    public boolean isSegWit() {
        return true;
    }
}
