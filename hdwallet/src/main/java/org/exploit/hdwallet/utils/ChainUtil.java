package org.exploit.hdwallet.utils;

import org.exploit.crypto.Hash;
import org.exploit.finja.utils.Eraser;
import org.exploit.hdwallet.model.ChainHash;

import java.util.Arrays;

public final class ChainUtil {
    private ChainUtil() {}

    public static ChainHash hash(byte[] currentChainCode, byte[] derivationData) {
        var i = Hash.hmacSha512(currentChainCode, derivationData);

        var il = Arrays.copyOfRange(i, 0, 32);
        var chainCode = Arrays.copyOfRange(i, 32, 64);

        Eraser.erase(i);

        return new ChainHash(il, chainCode);
    }
}
