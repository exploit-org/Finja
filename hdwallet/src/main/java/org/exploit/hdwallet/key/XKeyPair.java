package org.exploit.hdwallet.key;

import org.exploit.crypto.constant.SupportedCurve;
import org.exploit.crypto.key.ECKeyPair;
import org.exploit.finja.stereotype.Sensitive;

public abstract class XKeyPair implements Sensitive {
    private final XPrivateKey xPrivateKey;
    private final XPublicKey xPublicKey;

    public XKeyPair(XPrivateKey xPrivateKey, XPublicKey xPublicKey) {
        this.xPrivateKey = xPrivateKey;
        this.xPublicKey = xPublicKey;
    }

    public XPrivateKey xPrivateKey() {
        return xPrivateKey;
    }

    public XPublicKey xPublicKey() {
        return xPublicKey;
    }

    public abstract ECKeyPair asECKeyPair();

    public abstract XPrivateKey newPrivateKey(int childIndex, byte[] il, byte[] newChainCode, byte[] parentFingerprint, int depth);

    public abstract XPublicKey newPublicKey(XPrivateKey privateKey, byte[] il, byte[] chainCode, byte[] parentFingerPrint, int depth, int index);

    public abstract XKeyPair newKeyPair(XPrivateKey xPrivateKey, XPublicKey xPublicKey);

    public abstract SupportedCurve curve();

    @Override
    public void erase() {
        if (xPrivateKey != null) {
            xPrivateKey.erase();
        }
        xPublicKey.erase();
    }
}