package org.exploit.hdwallet.key;

import org.exploit.crypto.constant.SupportedCurve;
import org.exploit.crypto.key.ECKeyPair;
import org.exploit.finja.stereotype.Sensitive;
import org.exploit.tss.curve.PointOps;

public abstract class XKeyPair<P extends PointOps<P>> implements Sensitive {
    private final XPrivateKey xPrivateKey;
    private final XPublicKey<P> xPublicKey;

    public XKeyPair(XPrivateKey xPrivateKey, XPublicKey<P> xPublicKey) {
        this.xPrivateKey = xPrivateKey;
        this.xPublicKey = xPublicKey;
    }

    public XPrivateKey xPrivateKey() {
        return xPrivateKey;
    }

    public XPublicKey<P> xPublicKey() {
        return xPublicKey;
    }

    public abstract ECKeyPair<P> asECKeyPair();

    public abstract XPrivateKey newPrivateKey(int childIndex, byte[] il, byte[] newChainCode, byte[] parentFingerprint, int depth);

    public abstract XPublicKey<P> newPublicKey(XPrivateKey privateKey, byte[] il, byte[] chainCode, byte[] parentFingerPrint, int depth, int index);

    public abstract XKeyPair<P> newKeyPair(XPrivateKey xPrivateKey, XPublicKey<P> xPublicKey);

    public abstract SupportedCurve curve();

    @Override
    public void erase() {
        if (xPrivateKey != null) {
            xPrivateKey.erase();
        }
        xPublicKey.erase();
    }
}