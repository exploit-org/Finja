package org.exploit.sol.balance;

import org.exploit.finja.core.CoinBalanceService;
import org.exploit.finja.core.model.Value;
import org.exploit.sol.SolanaProvider;

import java.math.BigInteger;

public class SolanaBalanceService implements CoinBalanceService {
    private final SolanaProvider provider;

    public SolanaBalanceService(SolanaProvider provider) {
        this.provider = provider;
    }

    @Override
    public Value balance(String address) {
        var result = provider.getClient().getBalance(address).getResult()
                .getValue();

        var lamports = BigInteger.valueOf(result);
        var humanAmount = provider.converter().toHuman(lamports);

        return new Value(humanAmount, lamports);
    }
}
