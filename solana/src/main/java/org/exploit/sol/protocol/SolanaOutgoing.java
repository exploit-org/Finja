package org.exploit.sol.protocol;

import org.exploit.finja.core.OutgoingTransaction;
import org.exploit.finja.core.model.Receipt;
import org.exploit.sol.SolanaProvider;

public class SolanaOutgoing implements OutgoingTransaction {
    private final SolanaProvider provider;
    private final Transaction transaction;
    private final long expectedFee;

    public SolanaOutgoing(SolanaProvider provider, Transaction transaction, long expectedFee) {
        this.provider = provider;
        this.transaction = transaction;
        this.expectedFee = expectedFee;
    }

    @Override
    public String dump() {
        return transaction.toBase64();
    }

    @Override
    public Receipt send() {
        var txid = provider.getClient().sendTransaction(transaction.toBase64()).getResult();
        return new Receipt(txid, expectedFee);
    }

    @Override
    public long fee() {
        return expectedFee;
    }
}
