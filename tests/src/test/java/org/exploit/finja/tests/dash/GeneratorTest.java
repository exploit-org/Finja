package org.exploit.finja.tests.dash;

import org.exploit.crypto.WIF;
import org.exploit.crypto.key.secp256k1.Secp256k1KeyPair;
import org.exploit.dash.DashProvider;
import org.exploit.dash.constant.DashNetworkBytes;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class GeneratorTest {
    private final DashProvider provider = DashProvider.newBuilder().build();

    @Test
    public void assertValidGeneration() {
        var privateKeyDecoded = WIF.recoverKey("XGYRurpsrAWDK4fZSUboYApFRVCKQyqpL9MU79c7SJxVUPid6oeK".getBytes(),
                DashNetworkBytes.PRIVATE_KEY_MAINNET);

        var keyPair = Secp256k1KeyPair.create(privateKeyDecoded);
        var generated = provider.generator().generate(keyPair);

        assertEquals("XdGL4AiwD2Yvp8fQziBfRFWfETpextR2eZ", generated.publicAddress());
    }
}
