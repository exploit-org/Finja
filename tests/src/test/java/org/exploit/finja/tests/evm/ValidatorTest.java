package org.exploit.finja.tests.evm;

import org.exploit.evm.EvmProvider;
import org.exploit.evm.constant.ChainID;
import org.exploit.finja.core.model.WebData;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertTrue;

public class ValidatorTest {
    private final EvmProvider provider = EvmProvider.newBuilder()
            .node(WebData.create(null, null, null)) // Mock
            .chainId(ChainID.ETHEREUM)
            .build();

    @Test
    public void assertValidEthAddress() {
        var address = "0x1cB4A932d90eA229b18B4B42BDFFaF4627f1f38C";

        assertTrue(provider.validator().isValidAddress(address));
        assertTrue(provider.validator().isValidAddress(address.toLowerCase()));
    }

    @Test
    public void assertInvalidEthAddress() {
        var address = "0x1cB4A932d9FeA229b1DB4B42BDFFaF4627f1f38C";
        assertFalse(provider.validator().isValidAddress(address));
    }
}
