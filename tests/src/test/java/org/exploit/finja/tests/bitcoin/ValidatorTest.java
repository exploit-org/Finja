package org.exploit.finja.tests.bitcoin;

import org.exploit.btc.BitcoinProvider;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertTrue;

public class ValidatorTest {
    private final BitcoinProvider provider = BitcoinProvider.newBuilder().build();

    @Test
    public void assertValidSegWitAddress() {
        var mainnet = "bc1q7jrlxzrehll376nstkjy8l3nur089g46zpkkyq";
        var testnet = "tb1qlj64u6fqutr0xue85kl55fx0gt4m4urun25p7q";

        assertTrue(provider.validator().isValidAddress(mainnet));
        assertTrue(provider.validator().isValidAddress(testnet));
    }

    @Test
    public void assertValidLegacyAddress() {
        var mainnet = "bc1q7jrlxzrehll376nstkjy8l3nur089g46zpkkyq";
        var testnet = "tb1qlj64u6fqutr0xue85kl55fx0gt4m4urun25p7q";

        assertTrue(provider.validator().isValidAddress(mainnet));
        assertTrue(provider.validator().isValidAddress(testnet));
    }

    @Test
    public void assertValidTaprootAddress() {
        var mainnet = "bc1pvq7exnv4y80s03dncsu95gwcxe60v7ptun20t8rlfan5z0kgg98q5wk0zk";
        assertTrue(provider.validator().isValidAddress(mainnet));
    }
}
