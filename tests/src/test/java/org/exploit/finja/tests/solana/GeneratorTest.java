package org.exploit.finja.tests.solana;

import org.exploit.crypto.Base58;
import org.exploit.crypto.key.ed25519.Ed25519KeyPair;
import org.exploit.crypto.key.ed25519.Ed25519PrivateKey;
import org.exploit.finja.core.model.WebData;
import org.exploit.sol.SolanaProvider;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class GeneratorTest {
    private final SolanaProvider provider = SolanaProvider.newBuilder()
            .node(WebData.create(null, null)) // Mock
            .build();

    @Test
    public void assertValidGeneration() {
        var decoded = Base58.getInstance().decode("62xyrtAV3XXJftuuMBpXhHt9yvQZfo8DnUut4fx3LmyKXddszMRun475Zga1HDoTfXwgZZ5kiKbma1oizqBe7DVg");
        var privateKey = Ed25519PrivateKey.create(decoded);

        var generated = provider.generator().generate(Ed25519KeyPair.create(privateKey));
        assertEquals(generated.publicAddress(), "8HfXSJZ6eZJv5mPFmXxV3TFiM5PYikziyLYnsuD3UdB4");
    }
}