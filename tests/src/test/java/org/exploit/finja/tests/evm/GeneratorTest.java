package org.exploit.finja.tests.evm;

import org.exploit.crypto.key.secp256k1.Secp256k1KeyPair;
import org.exploit.finja.core.model.WebData;
import org.exploit.evm.EvmProvider;
import org.exploit.evm.constant.ChainID;
import org.exploit.evm.utils.EthKeys;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.assertEquals;

public class GeneratorTest {
    private final EvmProvider provider = EvmProvider.newBuilder()
            .node(WebData.create(null, null, null)) // Mock
            .chainId(ChainID.ETHEREUM)
            .build();

    @Test
    public void assertValidGeneration() {
        var privateKey = EthKeys.getPrivateKey("0x87e0aed85532c5328446454af8db80c3cff2bd8b111d0867042778e5db85e773");
        var keyPair = Secp256k1KeyPair.create(privateKey);

        var generated = provider.generator().generate(keyPair);
        assertEquals("0x1cB4A932d90eA229b18B4B42BDFFaF4627f1f38C".toLowerCase(), generated.publicAddress());
    }
}
